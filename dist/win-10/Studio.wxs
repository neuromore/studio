<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">

  <?ifndef $(var.APPNAME) ?>
    <?error APPNAME must be set ?>
  <?endif ?>
  <?ifndef $(var.APPCOMPANY) ?>
    <?error APPCOMPANY must be set ?>
  <?endif ?>
  <?ifndef $(var.VERSION) ?>
    <?error VERSION must be set ?>
  <?endif ?>

  <?if $(sys.BUILDARCH) = x64 ?>
    <?define PlatformProductName = "$(var.APPNAME) (x64)" ?>
    <?define PlatformUpgradeCode = "1AB189BA-5B13-4448-A916-4E25B814D2AA" ?>
  <?elseif $(sys.BUILDARCH) = x86 ?>
    <?define PlatformProductName = "$(var.APPNAME) (x86)" ?>
    <?define PlatformUpgradeCode = "1AB189BA-5B13-4448-A916-4E25B814D2AB" ?>
  <?elseif $(sys.BUILDARCH) = arm64 ?>
    <?define PlatformProductName = "$(var.APPNAME) (arm64)" ?>
    <?define PlatformUpgradeCode = "1AB189BA-5B13-4448-A916-4E25B814D2AC" ?>
  <?else ?>
    <?error Unsupported BUILDARCH ?>
  <?endif ?>

  <Package 
    Language="1033" 
    Manufacturer="$(var.APPCOMPANY)"
    Name="$(var.PlatformProductName)"
    UpgradeCode="$(var.PlatformUpgradeCode)"
    Version="$(var.VERSION)">
	
	<MajorUpgrade DowngradeErrorMessage="A later version of [ProductName] is already installed. Setup will now exit." />

    <MediaTemplate EmbedCab="yes" />

    <ComponentGroup Directory="INSTALLFOLDER" Id="ProductComponentGroup">
      <Component Id="Studio.exe">
        <File Id="Studio.exe" KeyPath="yes" Source="$(sys.BUILDARCH)/Studio.exe" />
      </Component>
    </ComponentGroup>

    <Feature Id="StudioFeature">
      <ComponentGroupRef Id="ProductComponentGroup" />
    </Feature>

    <StandardDirectory Id="ProgramFiles6432Folder">
      <Directory Id="INSTALLFOLDER" Name="$(var.APPNAME)" />
    </StandardDirectory>

  </Package>
</Wix>
